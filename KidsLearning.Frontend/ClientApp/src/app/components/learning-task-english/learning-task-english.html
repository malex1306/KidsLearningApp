@if (task) {
  <div class="task-detail-container">

    @if (!isCompleted && task.title === 'Englische Bilder') {
      <div class="quiz-area default-quiz">
        <div class="task-card glass-card image-card" style="text-align: center; margin: 1rem 0;">
          <h2 class="question-title">
            Frage {{ currentQuestionIndex + 1 }} von {{ task.questions.length }}
          </h2>
          <p class="question-text">{{ task.questions[currentQuestionIndex].text }}</p>
          <img [src]="task.questions[currentQuestionIndex].imageUrl || 'assets/images/bengal.png'"
               alt="Frage Bild" class="question-image" style="max-width: 100%; height: auto;">
        </div>

        <div class="options-grid" [class.disabled]="isWaitingForNext">
          @for (option of task.questions[currentQuestionIndex].options; track option) {
            <button class="option-button"
                    [ngClass]="{
                      'correct-answer': answerStatus === 'correct' && option === task.questions[currentQuestionIndex].correctAnswer,
                      'wrong-answer': answerStatus === 'wrong' && option !== task.questions[currentQuestionIndex].correctAnswer
                    }"
                    (click)="selectAnswer(option)">
              {{ option }}
            </button>
          }
        </div>

        @if (answerStatus) {
          <div class="status-message-container">
            <p [ngClass]="{'correct-text': answerStatus === 'correct', 'wrong-text': answerStatus === 'wrong'}">
              {{ statusMessage }}
            </p>
          </div>
        }
        <div class="navigation-buttons">
          @if (currentQuestionIndex === 0) {
            <a [routerLink]="['/tasks', task.subject, 'child', childId]" class="fun-button"> â¬… ZurÃ¼ck </a>
          } @else {
            <button class="fun-button" (click)="prevQuestion()"> â¬… Vorherige </button>
          }
          @if (currentQuestionIndex === task.questions.length - 1) {
            <a [routerLink]="['/tasks', task.subject, 'child', childId]" class="fun-button"> Beenden âœ… </a>
          } @else {
            <button class="fun-button" (click)="nextQuestion()"> NÃ¤chste âž¡ </button>
          }
        </div>
      </div>
    } @else if (!isCompleted && task.title === 'Deutsch/Englisch verbinden') {
      <div class="quiz-area default-quiz">
        <div class="task-card glass-card question-card">
          <div class="card-content">
            <h2 class="question-title">Verbinde die WÃ¶rter</h2>
            <p class="question-text">Klicke ein deutsches und das passende englische Wort.</p>
          </div>

          <div class="match-box">
            <div class="match-column">
              @for (de of shuffledGerman; track de) {
                @if (!isGermanConnected(de)){
                <button class="option-button"
                        [class.selected]="selectedGerman === de"
                        (click)="selectGerman(de)">
                  {{ de }}
                </button>
                }
              }
            </div>
            <div class="match-column">
              @for (en of shuffledEnglish; track en) {
                @if (!isEnglishConnected(en)){
                <button class="option-button"
                        [class.selected]="selectedEnglish === en"
                        (click)="selectEnglish(en)">
                  {{ en }}
                </button>
                }
              }
            </div>
          </div>
        </div>
        <div class="navigation-buttons">
          @if (currentBatchIndex === 0) {
            <a [routerLink]="['/tasks', task.subject, 'child', childId]" class="fun-button"> â¬… ZurÃ¼ck </a>
          } @else {
            <button class="fun-button" (click)="prevBatch()"> â¬… Vorherige  </button>
          }
          <span class="batch-info">Batch {{ currentBatchIndex + 1 }} von {{ Math.ceil(task.questions.length / batchSize) }} </span>
          @if (currentBatchIndex >= Math.ceil(task.questions.length / batchSize) - 1) {
            <a [routerLink]="['/tasks', task.subject, 'child', childId]" class="fun-button"> Beenden âœ… </a>
          } @else {
            <button class="fun-button" (click)="nextBatch()"> NÃ¤chste  âž¡ </button>
          }
        </div>
      </div>
    }

    @if (isCompleted) {
      <div class="completion-message-card glass-card">
        <div class="card-content">
          <h2>
            {{ task.title === 'Deutsch/Englisch verbinden' ? 'Alle Paare gefunden! ðŸŽ‰' : 'Aufgabe abgeschlossen! ðŸŽ‰' }}
          </h2>
          @if(task.title !== 'Deutsch/Englisch verbinden') {
            <p>Gut gemacht! Du hast alle Fragen beantwortet.</p>
          }
          <a [routerLink]="['/tasks', task.subject, 'child', childId]" class="back-button">
            Weiter zur nÃ¤chsten Seite
          </a>
        </div>
      </div>
    }
  </div>
}
